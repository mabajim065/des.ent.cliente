<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Robot Aspiradora</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f4f4f9;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h2 { color: #333; }

        .panel {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }

        table {
            border-collapse: collapse;
            margin: 0 auto;
            border: 4px solid #333;
        }

        td {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 24px;
            border: 1px solid #ddd;
            position: relative;
        }

        /* Estilos del Terreno */
        .suelo { background-color: #fff; }
        .sucio { background-color: #e0e0e0; position: relative; }
        .sucio::after {
            content: 'ðŸ’©'; /* RepresentaciÃ³n de suciedad */
            font-size: 20px;
            opacity: 0.6;
        }
        .pared { background-color: #2c3e50; border-color: #2c3e50; }
        
        /* El Robot */
        .robot {
            background-color: #3498db !important;
            color: white;
            border-radius: 50%;
            box-shadow: 0 0 10px #3498db;
            transition: all 0.2s;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:disabled { background: #95a5a6; }

        .info { font-weight: bold; margin-top: 10px; display: block; }
    </style>
</head>
<body>

    <div class="panel">
        <h2>ðŸ¤– Robot Limpiador</h2>
        <p>LÃ³gica: Avanza. Si chocas, gira a la derecha.</p>
        <button id="btnStart" onclick="iniciarLimpieza()">Encender Robot</button>
        <span class="info" id="status">BaterÃ­a: 100% | Suciedad limpiada: 0</span>
    </div>

    <table id="habitacion"></table>

    <script>
        // 0 = Suelo limpio, 1 = Pared, 2 = Suciedad
        const MAPA_BASE = [
            [1, 1, 1, 1, 1, 1, 1, 1],
            [1, 0, 2, 2, 0, 2, 0, 1],
            [1, 0, 1, 1, 0, 1, 2, 1],
            [1, 2, 2, 2, 0, 2, 2, 1],
            [1, 0, 1, 0, 0, 1, 0, 1],
            [1, 2, 0, 2, 2, 2, 0, 1],
            [1, 1, 1, 1, 1, 1, 1, 1]
        ];

        // Copia del mapa para jugar
        let mapa = [];
        let robot = { x: 1, y: 1, dir: 0, bateria: 100, basura: 0 };
        let intervalo;

        // VECTORES DE DIRECCIÃ“N (Sentido horario)
        // 0: Derecha (dy=1), 1: Abajo (dx=1), 2: Izquierda (dy=-1), 3: Arriba (dx=-1)
        const DIRECCIONES = [
            { dx: 0, dy: 1, icono: 'ðŸ‘‰' }, // Derecha
            { dx: 1, dy: 0, icono: 'ðŸ‘‡' }, // Abajo
            { dx: 0, dy: -1, icono: 'ðŸ‘ˆ' }, // Izquierda
            { dx: -1, dy: 0, icono: 'ðŸ‘†' }  // Arriba
        ];

        // --- 1. CONFIGURACIÃ“N Y RENDER ---
        function reiniciar() {
            // Clonamos el mapa base
            mapa = JSON.parse(JSON.stringify(MAPA_BASE));
            robot = { x: 1, y: 1, dir: 0, bateria: 20, basura: 0 }; // BaterÃ­a baja para probar el game over
            dibujar();
        }

        function dibujar() {
            const tabla = document.getElementById('habitacion');
            tabla.innerHTML = '';
            
            for(let i=0; i<mapa.length; i++) {
                const fila = tabla.insertRow();
                for(let j=0; j<mapa[0].length; j++) {
                    const celda = fila.insertCell();
                    
                    // Dibujar terreno
                    if (mapa[i][j] === 1) celda.classList.add('pared');
                    else if (mapa[i][j] === 2) celda.classList.add('sucio');
                    else celda.classList.add('suelo');

                    // Dibujar robot si estÃ¡ aquÃ­
                    if (i === robot.x && j === robot.y) {
                        celda.classList.remove('sucio'); // Visualmente el robot tapa la suciedad
                        celda.classList.add('robot');
                        celda.innerText = DIRECCIONES[robot.dir].icono;
                    }
                }
            }

            document.getElementById('status').innerText = 
                `BaterÃ­a: ${robot.bateria}% | Limpiado: ${robot.basura}`;
        }

        // --- 2. LÃ“GICA DE MOVIMIENTO (EXAMEN) ---
        function pasoLogico() {
            if (robot.bateria <= 0) {
                alert("Â¡BaterÃ­a agotada! Fin del ciclo.");
                clearInterval(intervalo);
                document.getElementById('btnStart').disabled = false;
                return;
            }

            // A. Limpiar celda actual si estÃ¡ sucia
            if (mapa[robot.x][robot.y] === 2) {
                mapa[robot.x][robot.y] = 0; // Se vuelve limpia
                robot.basura++;
                console.log("Â¡Basura aspirada!");
            }

            // B. Calcular INTENCIÃ“N de movimiento
            const vector = DIRECCIONES[robot.dir];
            const nextX = robot.x + vector.dx;
            const nextY = robot.y + vector.dy;

            // C. Verificar colisiÃ³n (Si es pared)
            if (mapa[nextX][nextY] === 1) {
                // CHOCA: Cambiar direcciÃ³n (Girar 90 grados a la derecha)
                // (0->1, 1->2, 2->3, 3->0)
                robot.dir = (robot.dir + 1) % 4;
                console.log("Pared detectada. Girando...");
                // Nota: No gastamos baterÃ­a al girar en este modelo simplificado, o sÃ­, depende del examen.
                // AquÃ­ solo giramos, no nos movemos en este turno.
            } else {
                // LIBRE: Avanzar
                robot.x = nextX;
                robot.y = nextY;
                robot.bateria--; // Avanzar gasta energÃ­a
            }

            dibujar();
        }

        function iniciarLimpieza() {
            reiniciar();
            document.getElementById('btnStart').disabled = true;
            
            // Ciclo de animaciÃ³n
            intervalo = setInterval(pasoLogico, 300); // 300ms por turno
        }

        // Inicio
        reiniciar();

    </script>
</body>
</html>